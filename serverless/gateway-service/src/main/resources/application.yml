server:
  port: 8082

spring:
  application:
    name: gateway-service
  cloud:
    gateway:
      default-filters:
        - AddResponseHeader=X-Gateway-Version, 1.0.0
      routes:
        - id: registry-service
          uri: ${REGISTRY_SERVICE_URL:http://localhost:8080}
          predicates:
            - Path=/api/v1/functions/**
        - id: executor-service
          uri: ${EXECUTOR_SERVICE_URL:http://localhost:8081}
          predicates:
            - Path=/api/v1/execute/**
        - id: registry-health
          uri: ${REGISTRY_SERVICE_URL:http://localhost:8080}
          predicates:
            - Path=/services/registry/health
          filters:
            - RewritePath=/services/registry/health, /actuator/health
        - id: executor-health
          uri: ${EXECUTOR_SERVICE_URL:http://localhost:8081}
          predicates:
            - Path=/services/executor/health
          filters:
            - RewritePath=/services/executor/health, /actuator/health

management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics,gateway
  endpoint:
    health:
      show-details: always
    gateway:
      enabled: true

logging:
  level:
    root: INFO
    hskl.cn.serverless: DEBUG
    org.springframework.cloud.gateway: DEBUG
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n"
